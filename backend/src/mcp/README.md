# MCP æ—¥æœŸè§£ææœå‹™å™¨

## ğŸ“ ç›®éŒ„çµæ§‹

```
mcp/
â”œâ”€â”€ server.py              # MCP æœå‹™å™¨å…¥å£
â”œâ”€â”€ config.yaml            # æœå‹™å™¨é…ç½®æª”æ¡ˆ
â”œâ”€â”€ README.md              # æœ¬æ–‡ä»¶
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ parse_time.py     # æ—¥æœŸæ™‚é–“è§£æå·¥å…·
â””â”€â”€ schemas/
    â””â”€â”€ tools.json        # å·¥å…·è¦æ ¼å®šç¾©ï¼ˆå¯é¸ï¼‰
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç›´æ¥é‹è¡Œ

```bash
python3 mcp/server.py
```

æœå‹™å™¨æœƒå¾æ¨™æº–è¼¸å…¥è®€å– JSON-RPC è«‹æ±‚ï¼Œä¸¦å°‡éŸ¿æ‡‰å¯«å…¥æ¨™æº–è¼¸å‡ºã€‚

### ä½œç‚ºæ¨¡çµ„ä½¿ç”¨

```python
from mcp_client import parse_date_via_mcp

result = parse_date_via_mcp("çµ¦æˆ‘ä»Šå¤©çš„å½±ç‰‡")
print(result)
```

## âš™ï¸ é…ç½®

ç·¨è¼¯ `config.yaml` ä¾†èª¿æ•´è¨­å®šï¼š

```yaml
# æ™‚å€è¨­å®š
timezone: "Asia/Taipei"

# æ—¥èªŒç­‰ç´š
log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
```

## ğŸ› ï¸ å·¥å…·

### parse_date

è§£æä¸­æ–‡æŸ¥è©¢ä¸­çš„æ—¥æœŸæ™‚é–“ç¯„åœã€‚

**æ”¯æ´çš„æ ¼å¼ï¼š**
- ç›¸å°æ—¥æœŸï¼šä»Šå¤©ã€æ˜¨å¤©ã€å‰å¤©ã€æ˜å¤©ã€æœ¬é€±ã€ä¸Šé€±ã€ä¸‹é€±
- MMDD æ ¼å¼ï¼š`1220`ã€`12/20`ã€`12-20`
- YYYYMMDD æ ¼å¼ï¼š`20251220`

**è¼¸å…¥ï¼š**
```json
{
  "query": "çµ¦æˆ‘ä»Šå¤©çš„å½±ç‰‡",
  "timezone": "Asia/Taipei"  // å¯é¸
}
```

**è¼¸å‡ºï¼š**
```json
{
  "mode": "RELATIVE_TODAY",
  "picked_date": "2025-12-29",
  "time_start": "2025-12-29T00:00:00+08:00",
  "time_end": "2025-12-30T00:00:00+08:00",
  "date_filter": "2025-12-29"
}
```

## ğŸ“ æ“´å±•

### æ·»åŠ æ–°å·¥å…·

1. åœ¨ `tools/` ç›®éŒ„ä¸‹å‰µå»ºæ–°çš„å·¥å…·æª”æ¡ˆ
2. åœ¨ `server.py` çš„ `handle_tools_call()` ä¸­æ·»åŠ è™•ç†é‚è¼¯
3. åœ¨ `schemas/tools.json` ä¸­æ·»åŠ å·¥å…·è¦æ ¼ï¼ˆå¯é¸ï¼‰

### ä¿®æ”¹é…ç½®

ç·¨è¼¯ `config.yaml` ä¸¦é‡å•Ÿæœå‹™å™¨ã€‚

## ğŸ”§ é–‹ç™¼

### æ¸¬è©¦

```bash
# æ¸¬è©¦æ—¥æœŸè§£æå·¥å…·
python3 -c "from mcp.tools.parse_time import parse_query_time_window; print(parse_query_time_window('çµ¦æˆ‘ä»Šå¤©çš„å½±ç‰‡'))"
```

### èª¿è©¦

è¨­ç½® `config.yaml` ä¸­çš„ `log_level: "DEBUG"` ä»¥æŸ¥çœ‹è©³ç´°æ—¥èªŒã€‚

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [MCP æµç¨‹èªªæ˜](../MCPæµç¨‹èªªæ˜.md)
- [æ—¥æœŸè§£æå·¥å…·æ–‡æª”](tools/parse_time.py)

